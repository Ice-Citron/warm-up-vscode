!function(){const vscode=acquireVsCodeApi();window.addEventListener("message",event=>{const message=event.data;if("allConfig"===message.type)setBoxBackgroundColor(),vscode.setState({allWords:message.words,allCodes:message.codes,language:message.language,codeLanguage:message.codeLanguage,count:message.count,mode:message.mode,punctuation:message.punctuation,colorBlindMode:message.colorBlindMode}),extensionState=vscode.getState(),allWords=message.words,allCodes=message.codes,setLanguage(message.language),setCodeLanguage(message.codeLanguage),setWordCount(message.count),setTimeCount(message.count),setTypingMode(message.mode),setColorBlindMode(message.colorBlindMode),setPunctuation(message.punctuation),"code snippets"===extensionState.mode?(setCodeText(),showCodeText()):(setText(),showText());else if("practiceWithSelection"===message.type)setBoxBackgroundColor(),vscode.setState({allWords:message.words,allCodes:message.codes,language:message.language,codeLanguage:message.codeLanguage,count:message.count,mode:message.mode,punctuation:message.punctuation,colorBlindMode:message.colorBlindMode}),extensionState=vscode.getState(),allWords=message.words,allCodes=message.codes,setLanguage(message.language),setCodeLanguage(message.codeLanguage),setWordCount(message.count),setTimeCount(message.count),setTypingMode(message.mode),setColorBlindMode(message.colorBlindMode),setPunctuation(message.punctuation),setSelectedCodeText(message.selectedCode,message.selectedCodeLanguage),showCodeText(message.selectedCodeLanguage);else switch(message.config){case"switchNaturalLanguage":message.value&&(setLanguage(message.value),vscode.setState({...extensionState,language:message.value}),extensionState=vscode.getState(),"code snippets"!==extensionState.mode&&(setText(),showText()));break;case"switchProgrammingLanguage":message.value&&(setCodeLanguage(message.value),vscode.setState({...extensionState,codeLanguage:message.value}),extensionState=vscode.getState(),"code snippets"===extensionState.mode&&(setCodeText(),showCodeText()));break;case"changeTypingMode":message.value&&(vscode.setState({...extensionState,mode:message.value}),extensionState=vscode.getState(),gameOver=!0,setTypingMode(message.value));break;case"togglePunctuation":message.value&&(setPunctuation(message.value),vscode.setState({...extensionState,punctuation:message.value}),extensionState=vscode.getState(),"code snippets"!==extensionState.mode&&(setText(),showText()));break;case"toggleColorBlindMode":setColorBlindMode(message.value),vscode.setState({...extensionState,colorBlindMode:message.value}),extensionState=vscode.getState();break;case"changeCount":message.value&&(setWordCount(message.value),setTimeCount(message.value),vscode.setState({...extensionState,count:message.value}),extensionState=vscode.getState(),"code snippets"!==extensionState.mode&&(setText(),showText()))}});const textDisplay=document.querySelector("#text-display"),inputField=document.querySelector("#input-field"),cursor=document.getElementById("cursor"),root=document.documentElement;let selectedLanguageWords=[],currentWordsList=[],currentWord=0,correctKeys=0,punctuation=!1,wordCount,timeCount,startDate=0,timerActive=!1,timer,allCodes=[],selectedLanguageCodes=[],selectedLanguageName="",currentCode="",gameOver=!0,codeStartDate=0,codeState={firstChar:null,lastChar:null,currentChar:null,currentCharNum:0,cursorLeftOffset:0,cursorTopOffset:0,linesLastCursorPositions:[]},extensionState=vscode.getState();function setTypingMode(_mode){const mode=_mode.toLowerCase();switch(mode){case"words (fixed amount)":document.querySelector("#coding-area").style.display="none",document.querySelector("#time-count").style.display="none",document.querySelector("#language-selected").style.display="none",document.querySelector("#typing-area").style.display="inline",document.querySelector("#word-count").style.display="inline",setText(),showText();break;case"words (against the clock)":document.querySelector("#coding-area").style.display="none",document.querySelector("#word-count").style.display="none",document.querySelector("#language-selected").style.display="none",document.querySelector("#typing-area").style.display="inline",document.querySelector("#time-count").style.display="inline",setText(),showText();break;case"code snippets":document.querySelector("#typing-area").style.display="none",document.querySelector("#word-count").style.display="none",document.querySelector("#time-count").style.display="none",document.querySelector("#coding-area").style.display="inline",document.querySelector("#language-selected").style.display="inline",setCodeText(),showCodeText();break;default:console.error(`Mode ${mode} is undefined`)}}function setColorBlindMode(_mode){let body=document.querySelector("body");"true"!==_mode||body.classList.contains("colorblind")||body.classList.add("colorblind"),"false"===_mode&&body.classList.contains("colorblind")&&body.classList.remove("colorblind")}function setBoxBackgroundColor(){let body=document.querySelector("body"),editorBackgroundColor=tinycolor(getComputedStyle(root).getPropertyValue("--editorBackgroundColor")),boxBackgroundColor="";boxBackgroundColor=editorBackgroundColor.isLight()?tinycolor(editorBackgroundColor).darken(4).toString():tinycolor(editorBackgroundColor).lighten(4).toString(),root.style.setProperty("--boxBackgroundColor",boxBackgroundColor)}function setText(e){var keepWordList=(e=e||window.event)&&e.shiftKey;switch(keepWordList||(currentWordsList=[]),currentWord=0,correctKeys=0,inputField.value="",timerActive=!1,clearTimeout(timer),textDisplay.style.display="block",inputField.className="",extensionState.mode){case"words (fixed amount)":if(textDisplay.style.height="auto",textDisplay.innerHTML="",!keepWordList)for(currentWordsList=[];currentWordsList.length<wordCount;){const randomWord=selectedLanguageWords[Math.floor(Math.random()*selectedLanguageWords.length)];currentWordsList[currentWordsList.length-1]===randomWord&&void 0!==currentWordsList[currentWordsList.length-1]||currentWordsList.push(randomWord)}break;case"words (against the clock)":if(textDisplay.style.height="3.2rem",document.querySelector(`#tc-${timeCount}`).innerHTML=timeCount,textDisplay.innerHTML="",!keepWordList)for(currentWordsList=[],i=0;i<500;i++){let n=Math.floor(Math.random()*selectedLanguageWords.length);currentWordsList.push(selectedLanguageWords[n])}}punctuation&&addPunctuations(),inputField.focus()}function showText(){currentWordsList.forEach(word=>{let span=document.createElement("span");span.innerHTML=word+" ",textDisplay.appendChild(span)}),textDisplay.firstChild.classList.add("highlight")}function showResult(){let words,minute,acc;switch(extensionState.mode){case"words (fixed amount)":words=correctKeys/5,minute=(Date.now()-startDate)/1e3/60;let totalKeys=-1;currentWordsList.forEach(e=>totalKeys+=e.length+1),acc=Math.floor(correctKeys/totalKeys*100);break;case"words (against the clock)":words=correctKeys/5,minute=timeCount/60;let sumKeys=-1;for(i=0;i<currentWord;i++)sumKeys+=currentWordsList[i].length+1;acc=acc=Math.min(Math.floor(correctKeys/sumKeys*100),100)}let wpm=Math.floor(words/minute);document.querySelector("#right-wing").innerHTML=`WPM: ${wpm} / ACC: ${acc}`}function addPunctuations(){if(void 0!==currentWordsList[0]){for(currentWordsList[0]=currentWordsList[0][0].toUpperCase()+currentWordsList[0].slice(1),i=0;i<currentWordsList.length;i++){const ran=Math.random();i<currentWordsList.length-1&&(ran<.03?currentWordsList[i]+=",":ran<.05?(currentWordsList[i]+=".",currentWordsList[i+1]=currentWordsList[i+1][0].toUpperCase()+currentWordsList[i+1].slice(1)):ran<.06?(currentWordsList[i]+="?",currentWordsList[i+1]=currentWordsList[i+1][0].toUpperCase()+currentWordsList[i+1].slice(1)):ran<.07?(currentWordsList[i]+="!",currentWordsList[i+1]=currentWordsList[i+1][0].toUpperCase()+currentWordsList[i+1].slice(1)):ran<.08&&(currentWordsList[i]+=";"))}currentWordsList[currentWordsList.length-1]+="."}}function setLanguage(lang){selectedLanguageWords=extensionState.allWords[lang]}function setPunctuation(punct){const punc=punct.toLowerCase();"true"===punc?punctuation=!0:"false"===punc&&(punctuation=!1)}function setWordCount(wc){wordCount=wc,document.querySelectorAll("#word-count > span").forEach(e=>e.style.borderBottom=""),document.querySelector(`#wc-${wordCount}`).style.borderBottom="2px solid",vscode.setState({...extensionState,count:wordCount}),extensionState=vscode.getState(),vscode.postMessage({command:"changeCount",count:wordCount})}function setTimeCount(tc){timeCount=tc,document.querySelectorAll("#time-count > span").forEach(e=>{e.style.borderBottom="",e.innerHTML=e.id.substring(3,6)}),document.querySelector(`#tc-${timeCount}`).style.borderBottom="2px solid",vscode.setState({...extensionState,count:timeCount}),extensionState=vscode.getState(),vscode.postMessage({command:"changeCount",count:timeCount})}function setCodeText(e){var keepWordList;document.querySelector("#language-selected").innerHTML=extensionState.codeLanguage.charAt(0).toUpperCase()+extensionState.codeLanguage.slice(1),(e=e||window.event)&&e.shiftKey||(currentCode=selectedLanguageCodes[Math.floor(Math.random()*selectedLanguageCodes.length)]),clearTimeout(timer),gameOver=!1,codeState={firstChar:null,lastChar:null,currentChar:null,currentCharNum:0,cursorLeftOffset:0,cursorTopOffset:0,linesLastCursorPositions:[]},cursor.classList.remove("hidden"),updateCursorPosition(0,0)}function setSelectedCodeText(selectedCode,selectedLanguage){currentCode=selectedCode,document.querySelector("#language-selected").innerHTML=selectedLanguage.charAt(0).toUpperCase()+selectedLanguage.slice(1),clearTimeout(timer),gameOver=!1,codeState={firstChar:null,lastChar:null,currentChar:null,currentCharNum:0,cursorLeftOffset:0,cursorTopOffset:0,linesLastCursorPositions:[]},cursor.classList.remove("hidden"),updateCursorPosition(0,0)}function showCodeText(userSelectedLanguage){highlightCode(currentCode,userSelectedLanguage||selectedLanguageName),updateStateChars(),document.getElementById("coding-area").focus()}function showCodeResults(){let numberOfCharacters=document.querySelectorAll(".char").length,numberOfCorrectTypings=document.querySelectorAll(".passed").length,time=(Date.now()-codeStartDate)/1e3/60,words=numberOfCorrectTypings/5,wpm=Math.floor(words/time),acc=Math.floor(numberOfCorrectTypings/numberOfCharacters*100);document.querySelector("#right-wing").innerHTML=`WPM: ${wpm} / ACC: ${acc}`}extensionState&&(setLanguage(extensionState.language),setCodeLanguage(extensionState.codeLanguage),setWordCount(extensionState.count),setTimeCount(extensionState.count),setTypingMode(extensionState.mode),setColorBlindMode(extensionState.mode),setPunctuation(extensionState.punctuation),setText(),showText()),document.querySelector("#restart-button").addEventListener("click",e=>{setText(e),showText()}),document.querySelector(".codeButton").addEventListener("click",e=>{setCodeText(e),showCodeText()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&("code snippets"===extensionState.mode?(setCodeText(e),showCodeText()):(setText(e),showText()))}),inputField.addEventListener("keydown",e=>{switch(extensionState.mode){case"words (fixed amount)":currentWord<currentWordsList.length&&inputFieldClass();case"words (against the clock)":timerActive&&inputFieldClass()}function inputFieldClass(){if(e.key>="a"&&e.key<="z"||"'"===e.key||","===e.key||"."===e.key||";"===e.key){let inputWordSlice=inputField.value+e.key,currentWordSlice=currentWordsList[currentWord].slice(0,inputWordSlice.length);inputField.className=inputWordSlice===currentWordSlice?"":"wrong"}else if("Backspace"===e.key){let inputWordSlice=e.ctrlKey?"":inputField.value.slice(0,inputField.value.length-1),currentWordSlice=currentWordsList[currentWord].slice(0,inputWordSlice.length);inputField.className=inputWordSlice===currentWordSlice?"":"wrong"}else" "===e.key&&(inputField.className="")}if(0===currentWord&&""===inputField.value)switch(extensionState.mode){case"words (fixed amount)":startDate=Date.now();break;case"words (against the clock)":function startTimer(time){time>0?(document.querySelector(`#tc-${timeCount}`).innerHTML=time,timer=setTimeout(()=>{startTimer(--time)},1e3)):(timerActive=!1,textDisplay.style.display="none",inputField.className="",document.querySelector(`#tc-${timeCount}`).innerHTML=timeCount,showResult())}timerActive||(startTimer(timeCount),timerActive=!0)}if(" "===e.key){if(e.preventDefault(),""!==inputField.value){if("words (against the clock)"===extensionState.mode){const currentWordPosition=textDisplay.childNodes[currentWord].getBoundingClientRect(),nextWordPosition=textDisplay.childNodes[currentWord+1].getBoundingClientRect();if(currentWordPosition.top<nextWordPosition.top)for(i=0;i<currentWord+1;i++)textDisplay.childNodes[i].style.display="none"}currentWord<currentWordsList.length-1?(inputField.value===currentWordsList[currentWord]?(textDisplay.childNodes[currentWord].classList.add("correct"),correctKeys+=currentWordsList[currentWord].length+1):textDisplay.childNodes[currentWord].classList.add("wrong"),textDisplay.childNodes[currentWord+1].classList.add("highlight")):currentWord===currentWordsList.length-1&&(textDisplay.childNodes[currentWord].classList.add("wrong"),showResult()),inputField.value="",currentWord++}}else currentWord===currentWordsList.length-1&&inputField.value+e.key===currentWordsList[currentWord]&&(textDisplay.childNodes[currentWord].classList.add("correct"),correctKeys+=currentWordsList[currentWord].length,currentWord++,showResult())}),document.querySelector("#wc-15").addEventListener("click",()=>{setWordCount(15),setText(),showText()}),document.querySelector("#wc-30").addEventListener("click",()=>{setWordCount(30),setText(),showText()}),document.querySelector("#wc-60").addEventListener("click",()=>{setWordCount(60),setText(),showText()}),document.querySelector("#wc-120").addEventListener("click",()=>{setWordCount(120),setText(),showText()}),document.querySelector("#wc-240").addEventListener("click",()=>{setWordCount(240),setText(),showText()}),document.querySelector("#tc-15").addEventListener("click",()=>{setTimeCount(15),setText(),showText()}),document.querySelector("#tc-30").addEventListener("click",()=>{setTimeCount(30),setText(),showText()}),document.querySelector("#tc-60").addEventListener("click",()=>{setTimeCount(60),setText(),showText()}),document.querySelector("#tc-120").addEventListener("click",()=>{setTimeCount(120),setText(),showText()}),document.querySelector("#tc-240").addEventListener("click",()=>{setTimeCount(240),setText(),showText()});let cursorWidth=.601*parseInt(getComputedStyle(root).getPropertyValue("--charSize").replace("px","")),cursorHeight=parseInt(1.5*getComputedStyle(root).getPropertyValue("--charSize").replace("px",""));function setCodeLanguage(lang){selectedLanguageName=lang,selectedLanguageCodes=allCodes[lang]}function updateStateChars(){const toPassSymbols=document.getElementsByClassName("topass");codeState={...codeState,firstChar:toPassSymbols[0],currentChar:toPassSymbols[0],lastChar:toPassSymbols[toPassSymbols.length-1]}}function highlightCode(codeSnippet,language){codeDiv=document.getElementById("code-code"),document.getElementById("code-pre").className="",document.getElementById("code-code").className="",codeDiv.classList.add(`language-${language}`),codeDiv.innerHTML=codeSnippet,Prism.highlightElement(codeDiv),codeDiv.innerHTML=cutCodeIntoPieces(codeDiv.innerHTML)}function cutCodeIntoPieces(highlightedCode){const regexpTag=/(<\/?span.*?>)/,tagsAndTextArr=highlightedCode.split(regexpTag),regexpSpecialChar=/&[a-z]*;/;let codeToRender="";for(let i=0;i<tagsAndTextArr.length;i++){if(""!==tagsAndTextArr[i]&&!regexpTag.test(tagsAndTextArr[i])){let newHtml="";if(regexpSpecialChar.test(tagsAndTextArr[i])){const specialCharsArr=tagsAndTextArr[i].match(/&[a-z]*;/g);if(1===specialCharsArr.length&&specialCharsArr[0]===tagsAndTextArr[i])newHtml+=`<span class="char topass">${tagsAndTextArr[i]}</span>`;else{const otherCharsArr=tagsAndTextArr[i].split(regexpSpecialChar);for(let j=0;j<otherCharsArr.length;j++)if(""===otherCharsArr[j]&&j<specialCharsArr.length)newHtml+=`<span class="char topass">${specialCharsArr[0]}</span>`;else{for(let k=0;k<otherCharsArr[j].length;k++)newHtml+=`<span class="char topass">${otherCharsArr[j][k]}</span>`;j!==otherCharsArr.length-1&&(newHtml+=`<span class="char topass">${specialCharsArr[0]}</span>`)}}}else for(let j=0;j<tagsAndTextArr[i].length;j++)newHtml+=`<span class="char topass">${tagsAndTextArr[i][j]}</span>`;tagsAndTextArr[i]=newHtml}codeToRender+=tagsAndTextArr[i]}return codeToRender}function getNextChar(){return document.getElementsByClassName("char")[codeState.currentCharNum+1]}function getPrevChar(){return document.getElementsByClassName("char")[codeState.currentCharNum-1]}function handleKeyDown(e){if(gameOver&&e.submit(),0===codeState.currentCharNum&&(codeStartDate=Date.now()),9===e.which){e.preventDefault();const currentChar=codeState.currentChar,currentCharCode=currentChar.innerText.charCodeAt(0);if(9===currentCharCode&&handleKeyPress(e),32===currentCharCode){let counter=0,summToAdd=0,currentEl=currentChar;for(;32===currentEl.innerText.charCodeAt(0);)summToAdd+=cursorWidth,currentEl.classList.remove("topass"),currentEl.classList.add("passed"),currentEl=currentEl.nextElementSibling,counter++;1===counter?flashCursor():(codeState={...codeState,currentCharNum:codeState.currentCharNum+(counter-1)},codeState={...codeState,cursorLeftOffset:codeState.cursorLeftOffset+summToAdd,currentChar:getNextChar(),currentCharNum:codeState.currentCharNum+1},updateCursorPosition(codeState.cursorLeftOffset,codeState.cursorTopOffset))}}if("Backspace"===e.key){if(codeState.currentChar===codeState.firstChar)return void flashCursor();const currentChar=getPrevChar(),currentCharCode=currentChar.innerText.charCodeAt(0);if(codeState={...codeState,currentChar:currentChar},currentChar.classList.remove("notpassed"),currentChar.classList.add("topass"),10===currentCharCode){const linesLastCursorPositions=codeState.linesLastCursorPositions;return codeState={...codeState,cursorLeftOffset:linesLastCursorPositions.pop(),cursorTopOffset:codeState.cursorTopOffset-cursorHeight,linesLastCursorPositions:linesLastCursorPositions,currentCharNum:codeState.currentCharNum-1},void updateCursorPosition(codeState.cursorLeftOffset,codeState.cursorTopOffset)}codeState={...codeState,cursorLeftOffset:codeState.cursorLeftOffset-cursorWidth,currentCharNum:codeState.currentCharNum-1},updateCursorPosition(codeState.cursorLeftOffset,codeState.cursorTopOffset)}}function handleKeyPress(e){gameOver&&e.submit(),e.preventDefault();const currentChar=codeState.currentChar,typedSymbolCode=e.which,currentCharCode=currentChar.innerText.charCodeAt(0);if(10===currentCharCode&&13!==typedSymbolCode)return void flashCursor();if(10!==currentCharCode&&13===typedSymbolCode)return void flashCursor();if(currentChar.classList.remove("topass"),typedSymbolCode===currentCharCode?currentChar.classList.add("passed"):currentChar.classList.add("notpassed"),codeState.currentChar===codeState.lastChar)return cursor.classList.add("hidden"),showCodeResults(),void(gameOver=!0);const next=getNextChar();if(codeState={...codeState,currentChar:next},10===currentCharCode&&13===typedSymbolCode){const linesLastCursorPositions=codeState.linesLastCursorPositions;return linesLastCursorPositions.push(codeState.cursorLeftOffset),codeState={...codeState,cursorLeftOffset:0,cursorTopOffset:codeState.cursorTopOffset+cursorHeight,linesLastCursorPositions:linesLastCursorPositions,currentCharNum:codeState.currentCharNum+1},void updateCursorPosition(codeState.cursorLeftOffset,codeState.cursorTopOffset)}if(9===currentCharCode)return codeState={...codeState,cursorLeftOffset:codeState.cursorLeftOffset+cursorWidth,currentCharNum:codeState.currentCharNum+1},void updateCursorPosition(codeState.cursorLeftOffset,codeState.cursorTopOffset);codeState={...codeState,cursorLeftOffset:codeState.cursorLeftOffset+cursorWidth,currentCharNum:codeState.currentCharNum+1},updateCursorPosition(codeState.cursorLeftOffset,codeState.cursorTopOffset)}function updateCursorPosition(left,top){cursor.style.left=`${left}px `,cursor.style.top=`${top}px`,cursor.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}function flashCursor(){cursor.style.background="#e0556170",setTimeout(()=>{cursor.style.background="#5dbeff"},100)}document.addEventListener("keydown",e=>handleKeyDown(e)),document.addEventListener("keypress",e=>handleKeyPress(e))}();